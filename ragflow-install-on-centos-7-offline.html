
<!DOCTYPE html>
<html lang="zh_cn">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet/less" type="text/css" href="./theme/stylesheet/style.less">
    <script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.5.1/less.min.js" type="text/javascript"></script>

  <link rel="stylesheet" type="text/css" href="./theme/pygments/friendly.min.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/font-awesome.min.css">

    <link href="./static/custom.css" rel="stylesheet">

    <link href="https://xingzuoshe.cn/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Martin's Blog Atom">


    <link rel="shortcut icon" href="/images/default_profile_200x200.png" type="image/x-icon">
    <link rel="icon" href="/images/default_profile_200x200.png" type="image/x-icon">


    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">

<meta name="author" content="Martin" />
<meta name="description" content="源码安装非常复杂，尽量用 docker 安装" />
<meta name="keywords" content="llm, ai">

<meta property="og:site_name" content="Martin's Blog"/>
<meta property="og:title" content="在 redhat/centos 7.9 上离线安装 raglow"/>
<meta property="og:description" content="源码安装非常复杂，尽量用 docker 安装"/>
<meta property="og:locale" content="zh_CN"/>
<meta property="og:url" content="./ragflow-install-on-centos-7-offline.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2024-08-21 18:00:00+08:00"/>
<meta property="article:modified_time" content="2024-08-21 18:00:00+08:00"/>
<meta property="article:author" content="./author/martin.html">
<meta property="article:section" content="Linux"/>
<meta property="article:tag" content="llm"/>
<meta property="article:tag" content="ai"/>
<meta property="og:image" content="/images/default_profile_200x200.png">

  <title>Martin's Blog &ndash; 在 redhat/centos 7.9 上离线安装 raglow</title>

</head>
<body>
  <aside>
    <div>
      <a href=".">
        <img src="/images/default_profile_200x200.png" alt="Martin's Blog" title="Martin's Blog">
      </a>
      <h1><a href=".">Martin's Blog</a></h1>

<p>Martin's Blog</p>
      <nav>
        <ul class="list">
          <li><a href="./pages/about.html#about">About</a></li>

          <li><a href="https://astrohub.cn" target="_blank">astrohub</a></li>
        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-github" href="https://github.com/openmartin" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-rss" href="/blog/feeds/all.atom.xml" target="_blank"><i class="fa fa-rss"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href=".">Home</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://xingzuoshe.cn/feeds/all.atom.xml">Atom</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="ragflow-install-on-centos-7-offline">在 redhat/centos 7.9 上离线安装 raglow</h1>
    <p>
      Posted on 2024-08-21 18:00 in <a href="./category/linux.html">Linux</a>

    </p>
  </header>


  <div>
    <p>众所周知还有很多企业用户被锁死在 redhat 7.9 上，一直没法升级，glibc 2.17，gcc 4，python 2，导致安装新一点软件的都是噩梦，所以尽量用 docker，减少因为系统环境浪费的时间。</p>
<p>需要有一台同样版本的 redhat/centos 7.9 而且可以联网的服务器，也可以去云上开一台，联网把依赖的包都下载下来，然后复制到离线的那台机器上去，基本的思路就是这样。</p>
<p>这里以 ragflow v0.9.0 的版本为例子</p>
<h2>如何用 docker 安装</h2>
<p>思路就是在联网的那台机器上拉取镜像，然后再导入离线的服务器上。可以自己搭建 docker 镜像代理，加速大陆地区的访问。</p>
<p>参考 docker/docker-compose-base.yml 和 docker/.env 文件，手动 pull 镜像</p>
<div class="highlight"><pre><span></span><code>docker pull docker.elastic.co/elasticsearch/elasticsearch:8.11.3
docker pull mysql:5.7.18
docker pull quay.io/minio/minio:RELEASE.2023-12-20T01-00-02Z
docker pull redis:7.2.4
docker pull ragflow:0.9.0

docker save -o es.tar docker.elastic.co/elasticsearch/elasticsearch:8.11.3
docker save -o mysql.tar mysql:5.7.18
docker save -o minio.tar quay.io/minio/minio:RELEASE.2023-12-20T01-00-02Z
docker save -o redis.tar redis:7.2.4
docker save -o ragflow.tar infiniflow/ragflow:v0.9.0
</code></pre></div>


<p>把上面那些tar文件传输到离线的服务器上，然后在离线的服务器上导入</p>
<div class="highlight"><pre><span></span><code><span class="n">docker</span> <span class="nb">load</span> <span class="o">-</span><span class="n">i</span> <span class="n">es</span><span class="o">.</span><span class="n">tar</span>
<span class="n">docker</span> <span class="nb">load</span> <span class="o">-</span><span class="n">i</span> <span class="n">mysql</span><span class="o">.</span><span class="n">tar</span>
<span class="n">docker</span> <span class="nb">load</span> <span class="o">-</span><span class="n">i</span> <span class="n">minio</span><span class="o">.</span><span class="n">tar</span>
<span class="n">docker</span> <span class="nb">load</span> <span class="o">-</span><span class="n">i</span> <span class="n">redis</span><span class="o">.</span><span class="n">tar</span>
<span class="n">docker</span> <span class="nb">load</span> <span class="o">-</span><span class="n">i</span> <span class="n">ragflow</span><span class="o">.</span><span class="n">tar</span>
</code></pre></div>


<p>然后就可已启动了， <code>docker compose -f docker/docker-compose-gpu.yml up -d</code></p>
<div class="highlight"><pre><span></span><code><span class="c1"># 查看日志</span>
docker logs -f ragflow-server
<span class="c1"># 进入容器的 shell</span>
docker <span class="nb">exec</span> -it ragflow-server sh
</code></pre></div>


<h2>如何使用源码安装</h2>
<h3>升级 gcc</h3>
<p>centos/redhat 7.9 默认带的 gcc 4.8.5 版本太旧，第一步就需要升级，不然很多需要源码编译安装的就过不去</p>
<p>先先找一个可以连外网的 centos 下载 rpm 包</p>
<div class="highlight"><pre><span></span><code>sudo yum -y install centos-release-scl
sudo yum -y install devtoolset-11 --downloadonly --downloaddir /home/centos/rpms/devtoolset-11
</code></pre></div>


<p>把 rpm 包传输到离线的服务器上，然后安装，切换到 gcc 11</p>
<div class="highlight"><pre><span></span><code>sudo rpm -ivh *.rpm --force --nodeps
scl <span class="nb">enable</span> devtoolset-11 bash
</code></pre></div>


<h3>升级 python 3.11，openssl，sqlite3</h3>
<p>centos/redhat 7.9 默认带的 openssl, sqlite3 版本太低，会影响 python 3.11 的编译安装，需要升级</p>
<p>openssl 的安装过程如下，为了简洁，不在详细解释了</p>
<div class="highlight"><pre><span></span><code><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">openssl</span><span class="o">/</span><span class="n">openssl</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">OpenSSL_1_1_1w</span><span class="o">/</span><span class="n">openssl</span><span class="o">-</span><span class="mf">1.1</span><span class="o">.</span><span class="mi">1</span><span class="n">w</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">tar</span> <span class="o">-</span><span class="n">zxvf</span> <span class="n">openssl</span><span class="o">-</span><span class="mf">1.1</span><span class="o">.</span><span class="mi">1</span><span class="n">w</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">cd</span> <span class="n">openssl</span><span class="o">-</span><span class="mf">1.1</span><span class="o">.</span><span class="mi">1</span><span class="n">w</span>
<span class="o">./</span><span class="n">config</span> <span class="o">--</span><span class="n">prefix</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">openssl</span> <span class="o">--</span><span class="n">openssldir</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">openssl</span>
<span class="n">make</span>
<span class="n">sudo</span> <span class="n">make</span> <span class="n">install</span>

<span class="c1"># 替换旧版本</span>
<span class="n">sudo</span> <span class="n">mv</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">openssl</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">openssl</span><span class="o">.</span><span class="n">bak</span>
<span class="n">sudo</span> <span class="n">mv</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">openssl</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">openssl</span><span class="o">.</span><span class="n">bak</span>

<span class="n">sudo</span> <span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">openssl</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">openssl</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">openssl</span>
<span class="n">sudo</span> <span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">openssl</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">openssl</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">openssl</span>
<span class="n">sudo</span> <span class="n">echo</span> <span class="s2">&quot;/usr/local/openssl/lib&quot;</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ld</span><span class="o">.</span><span class="n">so</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">openssl</span><span class="o">.</span><span class="n">conf</span>
<span class="n">sudo</span> <span class="n">ldconfig</span>

<span class="c1"># 查看 openssl 版本</span>
<span class="n">openssl</span> <span class="n">version</span>
</code></pre></div>


<p>sqlite3 的如下</p>
<div class="highlight"><pre><span></span><code><span class="n">wget</span>  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="p">.</span><span class="n">sqlite</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="mi">2024</span><span class="o">/</span><span class="n">sqlite</span><span class="o">-</span><span class="n">autoconf</span><span class="o">-</span><span class="mi">3460100</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
<span class="n">tar</span> <span class="o">-</span><span class="n">zxvf</span> <span class="n">sqlite</span><span class="o">-</span><span class="n">autoconf</span><span class="o">-</span><span class="mi">3460100</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
<span class="n">cd</span> <span class="n">sqlite</span><span class="o">-</span><span class="mi">3460100</span>
<span class="p">.</span><span class="o">/</span><span class="n">configure</span> <span class="c1">--prefix=/usr/local/sqlite3</span>
<span class="n">make</span>
<span class="n">sudo</span> <span class="n">make</span> <span class="n">install</span>


<span class="n">sudo</span> <span class="n">mv</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sqlite3</span>  <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sqlite3_old</span>
<span class="n">sudo</span> <span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="n">sqlite3</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sqlite3</span>   <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sqlite3</span>
<span class="n">sudo</span> <span class="n">echo</span> <span class="ss">&quot;/usr/local/sqlite3/lib&quot;</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ld</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">sqlite3</span><span class="p">.</span><span class="n">conf</span>
<span class="n">sudo</span> <span class="n">ldconfig</span>

<span class="o">#</span> <span class="err">查看</span> <span class="n">sqlite3</span> <span class="err">的版本</span>
<span class="n">sqlite3</span>
</code></pre></div>


<p>安装 python 3.11</p>
<div class="highlight"><pre><span></span><code>sudo yum install wget make cmake gcc bzip2-devel libffi-devel zlib-devel
<span class="c1"># 编译 Python</span>
<span class="nb">export</span> <span class="nv">makeLDFLAGS</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">LDFLAGS</span><span class="si">}</span><span class="s2"> -Wl,-rpath=/usr/local/openssl/lib:/usr/local/sqlite3/lib&quot;</span>
<span class="nb">export</span> <span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/usr/local/openssl/lib:/usr/local/sqlite3/lib
./configure --prefix<span class="o">=</span>/home/learnai/localpython --with-openssl<span class="o">=</span>/usr/local/openssl --enable-optimizations


make
make install
</code></pre></div>


<h3>pip 安装依赖</h3>
<h4>pytorch</h4>
<p>因为 centos/redhat 7.9 仅支持 cuda 11，所以安装 pytorch 需要指定 cuda 11</p>
<p>手工下载安装</p>
<div class="highlight"><pre><span></span><code><span class="err">torch-2.3.0+cu118-cp311-cp311-linux_x86_64.whl</span>
<span class="err">triton-2.3.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl</span>
</code></pre></div>


<h4>onnxruntime</h4>
<p>pypi 上下载的 onnxruntime 安装包需要比较新的 glibc 2.27, 所以只能自己从源码编译，需要在可以联网的那台机器上先编译，把编译好的包拷贝到离线的服务器上</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 1.17.3</span>
pip install <span class="nv">numpy</span><span class="o">==</span><span class="m">1</span>.26.4
pip install packaging
pip install wheel
./build.sh --config RelWithDebInfo --build_shared_lib --parallel --compile_no_warning_as_error --skip_submodule_sync --cmake_extra_defines <span class="nv">onnxruntime_BUILD_UNIT_TESTS</span><span class="o">=</span>OFF --build_wheel --skip_tests
<span class="c1"># 编译之后的结果</span>
onnxruntime-1.17.3/build/Linux/Release/dist/onnxruntime-1.17.3-cp311-cp311-linux_x86_64.whl


<span class="c1"># 1.17.1 cuda</span>
wget https://developer.download.nvidia.cn/compute/cudnn/redist/cudnn/linux-x86_64/cudnn-linux-x86_64-8.9.7.29_cuda11-archive.tar.xz
tar Jxvf cudnn-linux-x86_64-8.9.7.29_cuda11-archive.tar.xz
sudo mkdir /usr/local/cudnn-8.9.28_cuda11
sudo cp -r cudnn-linux-x86_64-8.9.7.29_cuda11-archive/ /usr/local/cudnn-8.9.28_cuda11/
sudo ln -s /usr/local/cudnn-8.9.28_cuda11 /usr/local/cudnn

./build.sh --config RelWithDebInfo --build_shared_lib --parallel --compile_no_warning_as_error --skip_submodule_sync --use_cuda --cudnn_home /usr/local/cudnn --cuda_home /usr/local/cuda --cmake_extra_defines <span class="nv">onnxruntime_BUILD_UNIT_TESTS</span><span class="o">=</span>OFF --build_wheel --skip_tests
<span class="c1"># 编译之后的结果</span>
onnxruntime-1.17.1/build/Linux/Release/dist/onnxruntime_gpu-1.17.1-cp311-cp311-linux_x86_64.whl
</code></pre></div>


<h4>requirements.txt</h4>
<p>先把 <code>requirements.txt</code> 中 jina 那一行注释掉，因为有以来冲突，而且一般用不到</p>
<p>先建立一个虚拟环境，然后安装依赖包</p>
<div class="highlight"><pre><span></span><code><span class="err">/home/learnai/localpython/bin/python3 -m venv ragflow_venv</span>
<span class="err">source ragflow_venv/bin/activate</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="err">先安装下面的包</span>
<span class="n">onnxruntime</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">17</span><span class="p">.</span><span class="mi">3</span>
<span class="n">onnxruntime_gpu</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">17</span><span class="p">.</span><span class="mi">1</span>
<span class="n">fastembed</span><span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="k">none</span><span class="o">-</span><span class="k">any</span><span class="p">.</span><span class="n">whl</span>
<span class="n">torch</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="o">+</span><span class="n">cu118</span><span class="o">-</span><span class="n">cp311</span><span class="o">-</span><span class="n">cp311</span><span class="o">-</span><span class="n">linux_x86_64</span><span class="p">.</span><span class="n">whl</span>
<span class="n">triton</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">cp311</span><span class="o">-</span><span class="n">cp311</span><span class="o">-</span><span class="n">manylinux_2_17_x86_64</span><span class="p">.</span><span class="n">manylinux2014_x86_64</span><span class="p">.</span><span class="n">whl</span>

<span class="o">#</span> <span class="err">安装其他包</span>
<span class="n">pip</span> <span class="n">intall</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>

<span class="n">pip</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">docx</span>
<span class="o">#</span> <span class="err">因为版本冲突，再安装一遍这个版本</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">pydantic</span><span class="o">=</span><span class="mi">2</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">2</span>
</code></pre></div>


<h3>其他基础软件</h3>
<p>为了省事，ES、MySQL、minio、redis 可以直接使用 docker 镜像启动</p>
<div class="highlight"><pre><span></span><code><span class="err">docker compose -f docker/docker-compose-base.yml up -d</span>
</code></pre></div>


<h3>前端代码编译</h3>
<p>下载 node-v18.19.1-linux-x64-glibc-217.tar.gz https://unofficial-builds.nodejs.org/download/release/v18.19.1/</p>
<div class="highlight"><pre><span></span><code>tar -zxvf node-v18.19.1-linux-x64-glibc-217.tar.gz
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/home/learnai/node-v18.19.1-linux-x64-glibc-217/bin
<span class="nb">cd</span> web
npm install --force --loglevel verbose
vim .umirc.ts
<span class="c1"># Update proxy.target to http://127.0.0.1:9380</span>
./node_modules/umi/bin/umi.js build
</code></pre></div>


<h3>后端运行</h3>
<p>在 ragflow v0.9.0 源码目录下</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span> <span class="n">PYTHONPATH</span><span class="o">=</span><span class="n n-Quoted">`pwd`</span>
</code></pre></div>


<p>下载 <a href="https://openaipublic.blob.core.windows.net/encodings/cl100k_base.tiktoken">cl100k_base.tiktoken</a> 然后上传到离线的服务器上，指定环境变量</p>
<p><code>export TIKTOKEN_CACHE_DIR=/home/learnai/tiktoken_cache</code></p>
<p>启动的时候 nltk 会报错，本地下载后上传到离线的服务器上</p>
<div class="highlight"><pre><span></span><code><span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;punkt&quot;</span><span class="p">)</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;wordnet&quot;</span><span class="p">)</span>
</code></pre></div>


<p><a href="https://hf-mirror.com/InfiniFlow/deepdoc">deepdoc</a> 模型本地下载后放在 /rag/res/deepdoc/ 下</p>
<div class="highlight"><pre><span></span><code><span class="err"># 后台任务</span>
<span class="err">python rag/svr/task_executor.py</span>
<span class="err"># web api</span>
<span class="err">python api/ragflow_server.py</span>
</code></pre></div>


<h3>Ollama 离线安装</h3>
<p><a href="https://blog.csdn.net/u010197332/article/details/137604798">https://blog.csdn.net/u010197332/article/details/137604798</a></p>
<p>参考这篇离线安装 ollama</p>
<p>因为没有网，所以 model 需要手工上传，然后指定路径 <code>export OLLAMA_MODEL=xxx</code></p>
<p>默认的使用的是联网的大模型，所以需要改成本地 ollama</p>
<p>conf/service_conf.yaml</p>
<div class="highlight"><pre><span></span><code><span class="n">user_default_llm</span><span class="o">:</span>
  <span class="n">factory</span><span class="o">:</span> <span class="s1">&#39;Ollama&#39;</span>
  <span class="n">api_key</span><span class="o">:</span> <span class="s1">&#39;sk-xxxxxxxxxxxxx&#39;</span>
  <span class="n">base_url</span><span class="o">:</span> <span class="s1">&#39;http://localhost:11434&#39;</span>
</code></pre></div>


<h3>前端运行</h3>
<p>参考官方文档，把编译之后的前端文件复制到 nginx 配置指定的目录下</p>
<div class="highlight"><pre><span></span><code><span class="err">sudo mkdir -p /ragflow/web</span>
<span class="err">cp -r dist /ragflow/web</span>
<span class="err">sudo yum install nginx -y</span>
<span class="err">sudo cp ../docker/nginx/proxy.conf /etc/nginx</span>
<span class="err">sudo cp ../docker/nginx/nginx.conf /etc/nginx</span>
<span class="err">sudo cp ../docker/nginx/ragflow.conf /etc/nginx/conf.d</span>
<span class="err">sudo systemctl start nginx</span>
</code></pre></div>


<p>如果没问题的话，现在就可以打开前端页面了 <code>http://ip:80/</code>, 如果有问题再针对性的查找问题</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="./tag/llm.html">llm</a>
      <a href="./tag/ai.html">ai</a>
    </p>
  </div>




    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle ads-responsive"
         data-ad-client="ca-pub-8640171181637141"
         data-ad-slot="4393383534"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'astro-2';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>&copy;  2020</p>
<p>Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a></p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Martin's Blog ",
  "url" : ".",
  "image": "/images/default_profile_200x200.png",
  "description": "Martin's Thoughts and Writings"
}
</script>

</body>
</html>